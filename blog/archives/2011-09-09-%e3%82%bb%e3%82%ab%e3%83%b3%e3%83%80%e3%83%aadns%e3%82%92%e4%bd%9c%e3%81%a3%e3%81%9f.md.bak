---
title: セカンダリDNSを作った
author: kongou_ae
layout: post
date: 2011-09-09
url: /blog/archives/462
categories:
  - DNS
---
　プライマリDNSの設定変更やアップデートに失敗した際に、aimless.jpがインターネットから見えなくなるのが嫌だったので、セカンダリDNSを構築しました。DNSを冗長化しても、すべてのコンテンツがプライマリDNS上に存在しているので、プライマリDNSのVPS自体に障害が発生した場合は何の意味もないのですが。。。。そこは別途考えよう。

　IPv6＋DNSSECな無料のセカンダリDNSサービスを探したのですが、なかなか見当たりません。DNSSEC未対応なセカンダリDNSを利用した場合、aimless.jpの検証が1/2の確率で失敗しそうな気がしたので、新しいVPS上に自前で用意しています。IPv6の到達性は、/126のアドレスではなくIHANet用のPrefixが欲しかったこともあり、HEのTunnelBrokerで確保しています。

　利用しているVSPはSaasesVPSです。「どこにすんべかー」ということで、とりあえずServersMan@VPSを契約してみたのですが、IHANetとHEとのトンネルに必要なip_greとipipのモジュールが無かった為、お試し期間中に契約即解約。次に契約したSaasesVPSにはこれらのモジュールがインストールされてたので、そのまま利用しています。

　HEとのトンネルが開通した後に、bindをインストールし、「実践DNS」を見ながらセカンダリDNSを設定した所、問題なくゾーン転送されました。ちょっと感動。

　最後にレジストラの管理画面を利用して、JPRSにセカンダリDNSを登録した所、セカンダリDNSが追加される代わりにDSレコードが消えるというアクシデントが発生。。。問い合わせてみた所、先方のトランザクション型申請インターフェースの仕様である事が判明し、改修を検討して頂けることになりました。よかったよかった。21-domain.comさんには色々とお手数をおかけしていて申し訳ないです。DSレコードの登録が管理画面上で出来るようになることを期待しています。