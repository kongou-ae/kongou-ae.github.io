---
title: Visioで構成管理
author: kongou_ae
layout: post
date: 2011-08-04
url: /blog/archives/346
categories:
  - network
---
　更新する資料が多くて困っていませんか？私は困っています。Visioのネットワーク図を更新した後に、Excelの機器管理台帳を更新するのが面倒で面倒で。。。。なぜ同じ情報を2度も入力しなければならないのか。。。

　色々と調べた結果、Visioのネットワーク図を更新するだけで済む方法を見つけたので、備忘の意味も含めてメモします。自宅PCにVisioが入っていないので、画面キャプチャはないです。。なお、使っているVisioは2007Proです。

### その1：Ciscoステンシルへのデータカテゴリ追加

　まずは下準備です。本手順は図形データ機能を利用します。基本ステンシルにはデータのカテゴリが作成済みなのですが、Ciscoのステンシルなどのマスタシェイプには図形データのカテゴリが作成されていないので、一から定義します。

1：ファイル＞図形を選択し、図形バーを表示
  
2：対象のステンシルのタイトルを右クリック＞ステンシルの編集
  
3：データを追加したいステンシルを右クリック＞マスタシェイプの編集＞マスタシェイプの編集
  
4：対象シェイプを右クリック＞データ＞図形データ
  
5：管理したいデータのカテゴリを定義する
  
6：上書き保存し、シェイプの編集を終了
  
7：データを追加したステンシルのタイトルを右クリック＞上書き保存 

### その2：対象機器へのデータ追加

　図形データのカテゴリを定義したステンシルを使い、ネットワーク図を作成します。その際に、各図形にデータを入力していきます。

1：表示＞図形データウィンドウを選択し、ウィンドウを表示する
  
2：データを追加したいステンシルを選択し、図形データウィンドウで粛々と情報を入力する 

### その3：データをラベルとして表示する</p> 

　入力した情報を図面上に表示します。ネットワーク図にホスト名や型番、IPアドレスはつきものです。これらの記載に新しいテキストツールを使うのは時間の無駄です。データとして登録したのですから、それを利用してラベルをつけましょう。

1：ツール＞アドオン＞地図とフロアプラン＞図形にラベルをつける
  
2：ラベル1～4で表示させたいカテゴリーを選択する 

　表示されたラベルは、フォントの書式で変更可能です。表示位置はテキストブロックツールで変更します。

　なお、残念なことに、データのカテゴリは図面上に最大4つしか表示させられません。。。表示させるなら「ホスト名、IPv4アドレス、IPv6アドレス、型番」の4つでしょうか。図面上に表示できる数は限りがありますが、後述するレポートには全て含める事が可能ですので、構成管理したい情報は全で入力しましょう。

### その4：データからレポートを作成

　先ほどデータとして入力した情報を利用してレポートを作成します。

1：データ＞レポートを選択
  
2：新規を選び、集計したいカテゴリ用のレポートを定義する
  
3：作成した定義を選択し、実行する 

　そうすると、良い感じの表が表示されるはずです。この表示順に合わせて構成管理台帳のフォームを作成しておき、表示された表を全コピー＞値貼り付けすれば、綺麗な構成管理台帳の完成です。

　ネットワークの情報が変更になった際には、ネットワーク図の修正（お絵かき＆データ）を行い、改めてレポート作成＞フォームに全コピペを行うだけで、Excelの管理台帳が最新になります。ネットワーク構成を変更したら、ネットワーク図は絶対直しますよね？？VisioとExcelを2度編集するよりは簡単だと思います。ネットワーク図と構成管理台帳に差異が出ちゃう現象も解消出来ますので、一石二鳥です。